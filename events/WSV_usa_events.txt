add_namespace = wsv_usa

## Rememberance Day parade
news_event = {
	id = wsv_usa.1
	title = wsv_usa.1.t
	desc = wsv_usa.1.d
	picture = news_event_rememberance_day

	major = no

	mean_time_to_happen = {
        days = 0 	
    }

    is_triggered_only = yes

	immediate = {
		if = {
			limit = {
				has_war = yes
				NOT = { has_country_flag = rememberance_riots_occured }
			}
			country_event = { id = wsv_usa.10  days = 1 }  # triggers riot event
			set_country_flag = rememberance_riots_occured
		}
	}
	
	option = {
		name = wsv_usa.1.a
		add_war_support = 0.02
		
	}
}


## State of US politics
country_event = {
	id = wsv_usa.2
	title = wsv_usa.2.t
	desc = wsv_usa.2.d

	fire_only_once = yes
	is_triggered_only = yes

    # side with socialists
	option = {
		name = wsv_usa.2.a
		trigger = { NOT = { USA_leonard_wood = { is_country_leader = yes} } } # cannot take if we have Wood
		set_country_flag = usa_work_with_socialists
		custom_effect_tooltip = unlock_socialist_path_tt
		ai_chance = { base = 60 }
	}

	# favour the army
	option = {
		name = wsv_usa.2.b
		trigger = { NOT = { USA_theodore_roosevelt = { is_country_leader = yes} } } # cannot take if we have TR
		set_country_flag = usa_favour_the_army
		custom_effect_tooltip = unlock_army_path_tt
		ai_chance = {
			base = 30
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
	}
}

	
## Election of 1912 ## (between TR & Wood) 
country_event = {
	id = wsv_usa.3
	title = wsv_usa.3.t
	desc = wsv_usa.3.d

	fire_only_once = yes

	mean_time_to_happen = {	days = 4 }

    trigger = {
    	tag = USA
        date > 1912.11.1
        date < 1913.10.10
        USA = {
	        has_elections = yes
        }
    }

    #teddy roosevelt
	option = {
		name = wsv_usa.3.a
		trigger = { NOT = { has_country_flag = usa_favour_the_army } }
		set_country_flag = USA_1912_election_occured

		custom_effect_tooltip = teddy_becomes_president_tt
		add_popularity = {
			ideology = democratic
			popularity = 0.05
		}
		add_popularity = {
			ideology = communism
			popularity = 0.05
		}
    	hidden_effect = {
    		retire_country_leader = yes
			promote_character = USA_theodore_roosevelt
    		set_politics = {
			    ruling_party = democratic
			    last_election = "1912.11.5"
			    election_frequency = 48
			    elections_allowed = yes
			}
			news_event = { id = wsv_usa.4  days = 1 }
    	}
    	
    	ai_chance = {
			base = 100
		}
	}

	#leonard wood
	option = {
		name = wsv_usa.3.b
		trigger = { NOT = { has_country_flag = usa_work_with_socialists } } 
		set_country_flag = USA_1912_election_occured
		
		custom_effect_tooltip = wood_becomes_president_tt
		add_popularity = {
			ideology = neutrality
			popularity = 0.05
		}
    	hidden_effect = {
    		retire_country_leader = yes
			promote_character = USA_leonard_wood
    		set_politics = {
			    ruling_party = democratic
			    last_election = "1912.11.5"
			    election_frequency = 48
			    elections_allowed = yes
			}
			news_event = { id = wsv_usa.5  days = 1 }
    	}
			
    	ai_chance = {
			base = 40

			modifier = {
				is_historical_focus_on = yes
				factor = 0
			}
		}
	}
}


# Teddy Roosevelt wins Presidency of USA
news_event = {
	id = wsv_usa.4
	title = wsv_usa.4.t
	desc = wsv_usa.4.d
	picture =   news_event_teddy_roosevelt_waving

	is_triggered_only = yes
	major = yes

	option = {
		name = wsv_usa.4.a
	}
}


# Leonard Wood wins Presidency of USA
news_event = {
	id = wsv_usa.5
	title = wsv_usa.5.t
	desc = wsv_usa.5.d
	picture =   news_event_leonard_wood

	is_triggered_only = yes
	major = yes

	option = {
		name = wsv_usa.5.a
	}
}


# Strike event
country_event = {
	id = wsv_usa.6
	title = wsv_usa.6.t
	desc = wsv_usa.6.d
	picture = report_event_generic_strike

	mean_time_to_happen = {
		days = 1
	}

	trigger = {
		tag = USA
		# trigger if the strike cooldown has expired
		NOT = { has_country_flag = strike_cooldown }
		# dont have strikes once this focus is done
		NOT = { has_country_flag = end_chronic_strikes }  
	}

	immediate = {
		hidden_effect = {
			if = {
				limit = { NOT = { has_idea = USA_worker_strikes } }
				add_ideas = USA_worker_strikes
				set_variable = { strike_popup_count = 0 }
			}
		}
	}

	# ignore strikers
	option = {
		name = wsv_usa.6.a
		# very unlikely for strike to end at first
		if = {
			limit = { check_variable = { USA.strike_popup_count < 2 } }
			random_list = {
				0 = { country_event = { id = wsv_usa.7  days = 5 } }   # strikes end
				100 = { }  # strikes continue
			}
		}
		# strike more likely to end later
		else = {
			random_list = {
				10 = { country_event = { id = wsv_usa.7  days = 5 } }   # strikes end
				90 = { }  # strikes continue
			}
		}
		add_to_variable = { USA.strike_popup_count = 1 }

		ai_chance = {
			factor = 25
		}
	}

	# make concessions
	option = {
		name = wsv_usa.6.b
		# cost depends on past decisions
		if = {
			limit = { has_country_flag = usa_work_with_socialists  }
			add_political_power = -15  	# cheaper since we're choosing to negociate
		}
		else_if = {
			limit = { has_country_flag = usa_favour_the_army }
			add_political_power = -35  # more expensive since we want to be tough
		}
		else = {
			add_political_power = -25
		}
		random_list = {
			30 = { country_event = { id = wsv_usa.7  days = 3 } }   # strikes end
			70 = { }  # strikes continue
		}
		add_to_variable = { USA.strike_popup_count = 1 }

		ai_chance = {
			factor = 40

			# less likely if low on pp
			modifier = {
				factor = 0.5
				has_political_power < 50
			}
			modifier = {
				factor = 0
				has_political_power < 25
			}
			# less likely if more militaristic
			modifier = {
				factor = 0.5   has_country_flag = usa_favour_the_army
			}
		}
	}

	# send in the military
	option = {
		name = wsv_usa.6.c
		trigger = {
			OR = {
				check_variable = { USA.strike_popup_count > 4 }
				AND = {
					has_country_flag = usa_crackdown_on_strikes
					check_variable = { USA.strike_popup_count > 1 }
				}
			}
		}
		country_event = { id = wsv_usa.7  days = 3 }   # strikes end
		increase_militancy_by_5_effect = yes

		ai_chance = {
			factor = 100
			modifier = {
				factor = 0.5
				check_variable = { USA.usa_socialist_militancy > 50 }
			}
			modifier = {
				factor = 0.5
				check_variable = { USA.usa_socialist_militancy > 75 }
			}
		}
	}
}


# Strike ends (normally)
country_event = {
	id = wsv_usa.7
	title = wsv_usa.7.t
	desc = wsv_usa.7.d

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			remove_ideas = USA_worker_strikes
			clear_variable = USA.strike_popup_count
			set_country_flag = { flag = strike_cooldown  value = 1  days = 225 }  # originally at 200
		}
	}

	option = {
		name = wsv_usa.7.a
	}
}


# Revise the naval budget
country_event = {
	id = wsv_usa.9
	title = wsv_usa.9.t
	desc = wsv_usa.9.d

	fire_only_once = yes
	is_triggered_only = yes

	# large naval funding increase
	option = {
		name = wsv_usa.9.a
		add_political_power = -75
		random_owned_controlled_state = {
			limit = { is_coastal = yes }
			add_extra_state_shared_building_slots = 3
			add_building_construction = {
				type = dockyard
				level = 3
				instant_build = yes
			}
		}
		ai_chance = {
			base = 20
			modifier = {
				factor = 2
				has_political_power > 75
			}
			modifier = {
				factor = 2
				has_political_power > 150
			}
		}
	}

	# small naval funding increase
	option = {
		name = wsv_usa.9.b
		add_political_power = -25
		random_owned_controlled_state = {
			limit = { is_coastal = yes }
			add_extra_state_shared_building_slots = 1
			add_building_construction = {
				type = dockyard
				level = 1
				instant_build = yes
			}
		}
		ai_chance = {
			base = 40
		}
	}

	# no change
	option = {
		name = wsv_usa.9.c
		add_political_power = 25
		ai_chance = {
			base = 0
			modifier = {
				add = 50
				has_political_power < -50
			}
		}
	}
}


#######################################################################
## -- No War 1916 Election
#######################################################################

## Notice to player of upcoming 1916 election (stop sitting on your ass)
country_event = {
	id = wsv_usa.10
	title = wsv_usa.10.t
	desc = wsv_usa.10.d

	fire_only_once = yes
	mean_time_to_happen = {
		days = 60
	}

	trigger = {
		tag = USA
		has_war = no
		has_idea = USA_remembrance_idea
		NOT = { has_country_flag = USA_1916_election }
		date > 1916.1.1
	}

	option = {
		name = wsv_usa.15.a
		add_stability = -0.05
		add_war_support = -0.1
		add_political_power = -50
	}
}


## Election of 1916 - No war (Debs auto wins)
country_event = {
	id = wsv_usa.11
	title = wsv_usa.11.t
	desc = wsv_usa.11.d

	fire_only_once = yes
	mean_time_to_happen = {	days = 4 }

    trigger = {
    	tag = USA
        date > 1916.11.1
        date < 1917.10.10
        has_elections = yes
		NOT = { has_country_flag = USA_1916_election }
		# why you not at war?
		has_war = no
		has_idea = USA_remembrance_idea
    }

	immediate = {
		set_country_flag = USA_1916_election
    }

	## debs wins (punishment for not fighting)
	option = {
		name = wsv_usa.17.a
		custom_effect_tooltip = debs_becomes_president_tt
		add_popularity = {
			ideology = communism
			popularity = 0.1
		}
		add_ideas = USA_demoralized_army_idea		# army gives up
    	hidden_effect = {
    		retire_country_leader = yes
			promote_character = USA_eugene_debs
    		set_politics = {
			    ruling_party = democratic	# socialists still represented as democratic when in power (for now)
			    last_election = "1916.11.5"
			    election_frequency = 48
			    elections_allowed = yes
			}
			news_event = { id = wsv_usa.12  days = 1 }
    	}
	}
}

# Debs wins Presidency (news event)
news_event = {
	id = wsv_usa.12
	title = wsv_usa.12.t
	desc = wsv_usa.12.d
	picture =   news_event_eugene_debs

	is_triggered_only = yes
	major = yes

	option = {
		name = wsv_usa.12.a
		trigger = { tag = USA }
	}

	option = {
		name = wsv_usa.12.b
		trigger = { NOT = { tag = USA } }
	}
}



#######################################################################
## -- War Issues During Teddy Roosevelt Presidency
#######################################################################


## Socialists get slightly mad that we went to war
country_event = {
	id = wsv_usa.14
	title = wsv_usa.14.t
	desc = wsv_usa.14.d

	fire_only_once = yes
	trigger = {
		tag = USA
		has_war_with_major = yes
		# woods gets a different event
		NOT = { 
			USA = { has_country_leader = { character = USA_leonard_wood   ruling_only = yes } } 
		} 
	}

	option = {
		name = wsv_usa.14.a
		increase_militancy_by_5_effect = yes
	}
}


## 1915 Rememberance day riots
country_event = {
	id = wsv_usa.15
	title = wsv_usa.15.t
	desc = wsv_usa.15.d
	picture = news_event_generic_riot

	fire_only_once = yes
	is_triggered_only = yes   # triggered by original rememberance event

	option = {
		name = wsv_usa.15.a
		add_stability = -0.05
		increase_militancy_by_10_effect = yes
	}
}


## Anti war demonstrations
country_event = {
	id = wsv_usa.16
	title = wsv_usa.16.t
	desc = wsv_usa.16.d
	picture = news_event_wsv_gathering_protest

	mean_time_to_happen = {
		days = 20
	}

	trigger = {
		tag = USA
		has_war_with_major = yes
		OR = {
			casualties > 1500000
			longest_war_length > 20
		}
		NOT = { has_country_flag = antiwar_protest_cooldown }
	}

	immediate = {
		if = {
			## TR gets protests less often
			limit = { 
				USA = { has_country_leader = { character = USA_theodore_roosevelt   ruling_only = yes } } }
			set_country_flag = {
				flag = antiwar_protest_cooldown
				days = 200
				value = 1
			}
		}
		else = {
			set_country_flag = {
				flag = antiwar_protest_cooldown
				days = 150
				value = 1
			}
		}
	}

	option = {
		name = wsv_usa.16.a
		add_war_support = -0.03
		add_stability = -0.01
	}
}


## Election of 1916 - TR is president & war time ##  
country_event = {
	id = wsv_usa.17
	title = wsv_usa.17.t
	desc = wsv_usa.17.d

	fire_only_once = yes
	mean_time_to_happen = {	days = 4 }

    trigger = {
    	tag = USA
        date > 1916.11.1
        date < 1917.10.10
        has_elections = yes
		USA_theodore_roosevelt = { is_country_leader = yes }
		has_war = yes
		NOT = { has_country_flag = USA_1916_election }
    }

	immediate = {
		set_country_flag = USA_1916_election
    }

	# teddy roosevelt
	option = {
		name = wsv_usa.17.a
		trigger = { surrender_progress < 0.25 }
		custom_effect_tooltip = TR_remains_president_tt
    	hidden_effect = {
    		set_politics = {
			    ruling_party = democratic
			    last_election = "1916.11.5"
			    election_frequency = 48
			    elections_allowed = yes
			}
			# TR is expected to win the war within a year
			set_country_flag = {
				flag = expected_peace_cooldown
				days = 275
				value = 1
			}
    	}
	}

	# Debs wins (only happens if losing the war)			
	option = {
		name = wsv_usa.17.b
		trigger = { surrender_progress > 0.25 }		# if the war is going badly we're voted out
		custom_effect_tooltip = debs_becomes_president_tt
		add_popularity = {
			ideology = communism
			popularity = 0.1
		}
    	news_event = { id = wsv_usa.40 }  # event takes care of stuff
	}
}


# Socialist block war funding (only if TR is still president)
country_event = {
	id = wsv_usa.18
	title = wsv_usa.18.t
	desc = wsv_usa.18.d

	mean_time_to_happen = {
		days = 1
	}

	trigger = {
		tag = USA
		has_war = yes
		has_country_flag = USA_1916_election
		USA = { has_country_leader = { character = USA_theodore_roosevelt   ruling_only = yes } }
		war_length_with = { tag = CSA  months = 42 }   # war length greater than 3.5 years -- canonically would trigger beginning of 1918
	}

	option = {
		name = wsv_usa.18.a
		add_war_support = -0.1
		add_ideas = USA_socialist_block_war_funds
		set_country_flag = {
			flag = expected_peace_cooldown
			days = 360
			value = 1
		} 
	}
}



#######################################################################
## -- Woods Presidency (during war time)
#######################################################################

## Socialists get very mad that we went to war (only for Woods)
country_event = {
	id = wsv_usa.20
	title = wsv_usa.20.t
	desc = wsv_usa.20.d

	fire_only_once = yes
	trigger = {
		tag = USA
		has_war_with_major = yes
		USA = { has_country_leader = { character = USA_leonard_wood   ruling_only = yes } } 
	}

	option = {
		name = wsv_usa.20.a
		increase_militancy_by_5_effect = yes
		add_war_support = -0.1
	}
}


## Election of 1916 - Woods is president & war time ##  
country_event = {
	id = wsv_usa.21
	title = wsv_usa.21.t
	desc = wsv_usa.21.d

	fire_only_once = yes
	mean_time_to_happen = {	days = 4 }

    trigger = {
    	tag = USA
        date > 1916.11.1
        date < 1917.10.10
        has_elections = yes
		USA_leonard_wood = { is_country_leader = yes }
		has_war = yes
		NOT = { has_country_flag = USA_1916_election }
    }

	immediate = {
		set_country_flag = USA_1916_election
    }

	# Woods wins handidly
	option = {
		name = wsv_usa.21.a
		trigger = { surrender_progress < 0.1 }	# only if war is going well (much smaller margin of error than TR)
		custom_effect_tooltip = woods_remains_president_tt
    	hidden_effect = {
    		set_politics = {
			    ruling_party = democratic
			    last_election = "1916.11.5"
			    election_frequency = 48
			    elections_allowed = yes
			}
    	}
	}

	# Debs wins... 		
	option = {
		name = wsv_usa.21.b
		trigger = { surrender_progress > 0.1 }		# if the war is going badly we're voted out
		custom_effect_tooltip = debs_becomes_president_tt
		add_popularity = {
			ideology = communism
			popularity = 0.1
		}
		news_event = { id = wsv_usa.40 }  # event takes care of stuff
		ai_chance = { factor = 1 }  
	}

	# Nullify the election (Debs won)
	option = {
		name = wsv_usa.21.c
		trigger = { 
			surrender_progress > 0.1  # if the war is going badly we're voted out
			has_completed_focus = USA_military_dictatorship 
		}		
		news_event = { id = wsv_usa.22  days = 3 }
		custom_effect_tooltip = likely_lead_to_usa_civil_war_tt
		ai_chance = { factor = 100 }
	}
}


# Coup in the US (elections nullified)
news_event = {
	id = wsv_usa.22
	title = wsv_usa.22.t
	desc = wsv_usa.22.d
	picture =  news_event_woods_coup

	is_triggered_only = yes
	major = yes

	immediate = {
		set_global_flag = usa_coup_conducted_by_woods
		hidden_effect = {
			USA = {
				set_politics = {
					ruling_party = neutrality
					last_election = "1916.11.5"
					election_frequency = 48
					elections_allowed = no
				}
				promote_character = USA_leonard_wood   # make sure he's president
				if = {
					# socialists will automatically start militarizing
					limit = { check_variable = { USA.usa_socialist_militancy < 45 } }
					set_variable = { USA.usa_socialist_militancy = 65 }
				}
				else = {
					increase_militancy_by_20_effect = yes
				}
			}
		}
	}

	option = {
		name = wsv_usa.22.a
		trigger = { tag = USA }
	}

	option = {
		name = wsv_usa.22.b
		trigger = { NOT = { tag = USA } }
	}
}


## Mass protest against election overturn
country_event = {
	id = wsv_usa.23
	title = wsv_usa.23.t
	desc = wsv_usa.23.d
	picture = report_event_generic_riot

	fire_only_once = yes
	trigger = {
		has_global_flag = usa_coup_conducted_by_woods
		NOT = { has_civil_war = no }
	}

	option = {
		name = wsv_usa.23.a
		add_stability = -0.15
		add_war_support = -0.2
	}
}



#######################################################################
## -- Debs Wins 1916 Election (and effects)
#######################################################################

# Debs wins Presidency (news event)
news_event = {
	id = wsv_usa.40
	title = wsv_usa.40.t
	desc = wsv_usa.40.d
	picture =   news_event_eugene_debs

	is_triggered_only = yes
	major = yes

	immediate = {
		hidden_effect = {
			USA = {
				retire_country_leader = yes
				promote_character = USA_eugene_debs
				set_politics = {
					ruling_party = communism
					last_election = "1916.11.5"
					election_frequency = 48
					elections_allowed = yes
				}
				# army doesnt want to fight for socialists
				add_ideas = USA_demoralized_army_idea
				# Debs is expected to peace out within a year
				set_country_flag = {
					flag = expected_peace_cooldown
					days = 275
					value = 1
				}
			}
		}
	}

	option = {
		name = wsv_usa.40.a
		trigger = { tag = USA }
	}

	option = {
		name = wsv_usa.40.b
		trigger = { NOT = { tag = USA } }
	}
}


# Start peace negociations with Confederates & British
country_event = {
	id = wsv_usa.41
	title = wsv_usa.41.t
	desc = wsv_usa.41.d

	fire_only_once = yes
	mean_time_to_happen = {
		days = 10
	}

	trigger = {
		tag = USA
		has_war_with = CSA
		USA_eugene_debs = { is_country_leader = yes }
		has_country_flag = USA_1916_election
		date > 1917.3.4
	}

	option = {
		name = wsv_usa.41.a
		CSA = { country_event = { id = wsv_usa.42  days = 1 } }
	}
}


## Confederates recieve peace offer
country_event = {
	id = wsv_usa.42
	title = wsv_usa.42.t
	desc = wsv_usa.42.d

	fire_only_once = yes
	is_triggered_only = yes

	# Tell them our terms
	option = {
		name = wsv_usa.42.a	
		USA = { country_event = { id = wsv_usa.43  days = 1 } }
		ai_chance = { 
			factor = 40 
		}
		custom_effect_tooltip = confederate_compromise_peace_terms_tt
	}

	# Reject all compromised peace
	option = {
		name = wsv_usa.42.b	
		USA = { country_event = { id = wsv_usa.45  days = 1 } }
		ai_chance = { 
			factor = 0 
			modifier = {
				add = 70
				USA = { surrender_progress > 0.45 }
			}
		}
	}
}


## Recieved Confederate peace terms
country_event = {
	id = wsv_usa.43
	title = wsv_usa.43.t
	desc = wsv_usa.43.d

	fire_only_once = yes
	is_triggered_only = yes

	# Accept terms
	option = {
		name = wsv_usa.43.a	
		news_event = wsv_usa.44
		ai_chance = { factor = 100 }
	}

	# Reject terms
	option = {
		name = wsv_usa.43.b
		news_event = wsv_usa.46
		ai_chance = { factor = 0 }
	}
}


# Compromise peace in North America (news event) 
news_event = {
	id = wsv_usa.44
	title = wsv_usa.44.t
	desc = wsv_usa.44.d
	picture = news_event_sign_treaty

	is_triggered_only = yes
	major = yes

	immediate = {
		hidden_effect = {
			set_global_flag = usa_compromised_peace_with_csa
			# transfer territory to CSA
			CSA = {
				transfer_state = 847
				transfer_state = 848
				361 = { set_demilitarized_zone = yes }
				if = { 
					limit = { controls_state = 318 }
					annex_country = { target = HAI  transfer_troops = no }
				}
			}
			# have USA annex DES and leave faction
			USA = {
				if = { 
					limit = { has_war_with = DES } 
					annex_country = { target = DES  transfer_troops = no }
				}
				if = {
					limit = { is_in_faction = yes }
					if = { 
						limit = { is_faction_leader = yes }
						dismantle_faction = yes
					}
					else = {
						leave_faction = yes
					}
				}
				greatwar_loser_effect = yes
			}
			every_country = {
				limit = { 
					has_war_with = USA
					is_in_faction_with = CSA
				}
				white_peace = USA
			}
		}
	}

	option = {
		name = wsv_usa.44.a
	}
}


# Confederate reject all peace negotiations
country_event = {
	id = wsv_usa.45
	title = wsv_usa.45.t
	desc = wsv_usa.45.d

	fire_only_once = yes
	is_triggered_only = yes

	option = {
		name = wsv_usa.45.a
		news_event = wsv_usa.46
	}
}


# No peace in North America (news event)
news_event = {
	id = wsv_usa.46
	title = wsv_usa.46.t
	desc = wsv_usa.46.d
	picture = news_event_soldiers_in_trenches

	immediate = {
		hidden_effect = {
			USA = { set_country_flag = usa_socialists_failed_to_bring_peace } 
		}
	}

	is_triggered_only = yes
	major = yes

	option = {
		name = wsv_usa.46.a
	}
}





#######################################################################
## -- Socialist Party Split & Socialist Revolt (Any Leader)
#######################################################################

# American Socialist Party splits ##
country_event = {
	id = wsv_usa.50
	title = wsv_usa.50.t
	desc = wsv_usa.50.d
	picture =  news_event_usa_socialist_party_split

	fire_only_once = yes
	mean_time_to_happen = {	days = 90 }

    trigger = {
    	tag = USA
		has_war_with_major = yes
		OR = {
			# TR / Debs failed to bring peace after election
			AND = {
				has_country_flag = USA_1916_election
				NOT = { has_country_flag = expected_peace_cooldown }
			}
			# Alternatively split when militancy becomes high
			check_variable = { USA.usa_socialist_militancy > 59 } 
		}
    }

	immediate = {
		set_country_flag = usa_socialist_party_split
    }

	# thats not good
	option = {
		name = wsv_usa.50.a
		add_stability = -0.05
		# dont increase militancy if this triggered due to militancy increase
		if = {
			limit = { check_variable = { USA.usa_socialist_militancy < 60 } }
			increase_militancy_by_10_effect = yes
		}
	}
}


# Socialist militants forming
country_event = {
	id = wsv_usa.51
	title = wsv_usa.51.t
	desc = wsv_usa.51.d
	picture = report_event_generic_partisans

	mean_time_to_happen = {
		days = 10
	}

	trigger = {
		tag = USA
		has_country_flag = usa_socialist_party_split
		NOT = { has_government = communism }
		# dont do if cooling down
		NOT = { has_country_flag = militants_cooldown }
		# once revolt starts we dont need these
		NOT = { has_country_flag = usa_socialist_revolt }
	}

	immediate = {
		hidden_effect = {
			set_country_flag = {
				flag = militants_cooldown
				value = 1
				days = 150
			}
		}
	}

	option = {
		name = wsv_usa.51.a
		increase_militancy_by_10_effect = yes
		add_stability = -0.02
	}
}


### --- American Socialist Revolt  --- ####
news_event = {
	id = wsv_usa.55
	title = wsv_usa.55.t
	desc = wsv_usa.55.d
	picture = news_event_workers_rebellion

	fire_only_once = yes
	mean_time_to_happen = {	days = 30 }

    trigger = {
    	tag = USA
		has_war = yes
		check_variable = { USA.usa_socialist_militancy > 99 }
		NOT = { has_global_flag = usa_socialist_revolt }
    }

	immediate = {
		set_global_flag = usa_socialist_revolt
		hidden_effect = {
			# Democrats stay in power
			start_civil_war = {
				ideology = communism
				size = 0.15
				states = {
					358
				}
			}
			# set stats for Communist rebels
			random_other_country = {
				limit = {
					original_tag = USA
					has_government = communism
				}
				#save_event_target_as = USA_communist_side
				load_oob = "USA_socialist_newyork_revolt" 
				set_equipment_fraction = 0.05
				set_stability = 0.65
				set_war_support = 0.8
				promote_character = USA_ce_ruthenburg
				set_popularities = {
					democratic = 15
					communism = 75
					neutrality = 5
					fascism = 5
				}
				add_political_power = 250
			}
			# expand revolt in a few days
			country_event = { id = wsv_usa.56   days = 10 }
		}
    }

	# thats not good
	option = {
		name = wsv_usa.55.a
	}
}


## Revolt expands to the Rust Belt
country_event = {
	id = wsv_usa.56
	title = wsv_usa.56.t
	desc = wsv_usa.56.d
	picture = report_event_generic_civil_war_2

	fire_only_once = yes
	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			if = {
				limit = { USA = { has_civil_war = yes } }
				random_other_country = {
					limit = {
						original_tag = USA
						has_government = communism
					}
					save_event_target_as = USA_communist_side
					transfer_state = 851
					transfer_state = 839
					transfer_state = 850
					load_oob = "USA_socialist_newyork_revolt"   # new york expands
					load_oob = "USA_rustbelt_revolt" 
				}
				USA = {
					transfer_units_fraction= {
						target = event_target:USA_communist_side
						size = 0.01
						stockpile_ratio = 0.2
						army_ratio = 0.15
						air_ratio = 0.08
					}
				}
			}
		}
	}

	option = {
		name = wsv_usa.56.a
		add_stability = -0.1
	}
}



##########################################################
#################### MORMON REVOLT #######################
##########################################################


news_event = {
	id = wsv_usa.100
	title = wsv_usa.100.t
	desc = wsv_usa.100.d
	picture = news_event_USA_mormon_revolt

	major = yes

	mean_time_to_happen = {	
        days = 45 		#around easter
    }

    trigger = {
    	tag = USA
        date > 1915.3.1	
        date < 1916.3.1		
        USA = { 
     		has_war_with = CSA
     		NOT =  { has_war_with = DES }
     	}
       	DES = { NOT = { has_full_control_of_state = 380 } }
        NOT = { has_global_flag = second_mormon_revolt }
    }

    immediate = {
    	hidden_effect = {
	    	set_global_flag = second_mormon_revolt
	    	DES = {
				transfer_state = 380
				add_state_core = 380
				set_stability = 0.9
				set_war_support = 0.6
				load_oob = "DES_revolt"
				set_division_template_lock = { division_template = "Mormon Fighters"   is_locked = yes }
				add_political_power = 500
				add_equipment_to_stockpile = {
				    type = infantry_equipment_0
				    amount = 5000
				    producer = USA
				}
				delete_unit_template_and_units = { division_template = "Infantry Division" }
				delete_unit_template_and_units = { division_template = "Siege Division" }
				delete_unit_template_and_units = { division_template = "National Guard" }
				delete_unit_template_and_units = { division_template = "Dragoon Division" }		
			}
			USA =  {
				load_oob = "USA_mormon_revolt"
				set_division_template_lock = { division_template = "State Troopers"   is_locked = yes }
				add_equipment_to_stockpile = {
				    type = infantry_equipment_0
				    amount = -5000
				    producer = USA
				}
				remove_state_core = 380
				add_state_claim = 380
				declare_war_on = {
				    target = DES
				    type = annex_everything
				}
			}
		}
    }
	
	option = {
		name = wsv_usa.100.a
		trigger = { tag = USA }
	}

	option = {
		name = wsv_usa.100.b
		trigger = { tag = CSA }
	}

	option = {
		name = wsv_usa.45.c
		trigger = { 
			NOT = { tag = USA }
			NOT = { tag = CSA }
		}
	}
}


# what to do with mormon leaders
country_event = {
	id = wsv_usa.101
	title = wsv_usa.101.t
	desc = wsv_usa.101.d
	picture = report_event_mormon_leaders

	fire_only_once = yes

	trigger = {
		tag = USA
		has_war_with = DES
		DES = { has_capitulated = yes }
	}

	immediate = {
		hidden_effect = {  # if CSA wins they'll free the mormons later
			annex_country = { target = DES  transfer_troops = no }
			delete_unit_template_and_units = {
				division_template = "State Troopers"
    			disband = no 
			}
		}
	}

    #hang_them
	option = {
		name = wsv_usa.101.a
		380 = {
			start_resistance = yes
			set_compliance = 6
			set_resistance = 45
		}
		ai_chance = {
			factor = 100
		}
	}

	#imprison them
	option = {
		name = wsv_usa.101.b
		380 = {
			start_resistance = yes
			set_compliance = 12
			set_resistance = 25
		}
    	ai_chance = {
			factor = 0
		}
	}
}



##########################################################
################## AMERICAN-GERMAN PACT ##################
##########################################################


# USA asks for pact (Germany is ROOT)
country_event = {
	id = wsv_usa.103
	title = wsv_usa.103.t
	desc = wsv_usa.103.d

	is_triggered_only = yes

	# yes
	option = {
		name = wsv_usa.103.a
		set_global_flag = american_german_pact
		USA = {
			country_event = { id = wsv_usa.104  days = 2 }
		}
		custom_effect_tooltip = american_german_pact_conditions_tt
		hidden_effect = {
			GER = { give_guarantee = USA }
			USA = { give_guarantee = GER }
			news_event = { days = 2   id = wsv_usa.106 }
		}

		ai_chance = {
			base = 100
		}
	}

	# no
	option = {
		name = wsv_usa.103.a
		set_country_flag = rejected_pact_with_us
		USA = {
			country_event = { id = wsv_usa.105  days = 2 }
			diplomatic_relation = {
				country = GER
				relation = non_aggression_pact
				active = no
			}
			add_opinion_modifier = {
				target = GER
				modifier = WSV_dislikes_country
			}
		}

		ai_chance = {
			base = 20
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
	}
}


# Germany accepts
country_event = {
	id = wsv_usa.104
	title = wsv_usa.104.t
	desc = wsv_usa.104.d

	is_triggered_only = yes

	option = {
		name = wsv_usa.104.a
	}
}


# Germany rejects
country_event = {
	id = wsv_usa.105
	title = wsv_usa.105.t
	desc = wsv_usa.105.d

	is_triggered_only = yes

	# thats not good
	option = {
		name = wsv_usa.105.a

	}
}


# News event of American-German Pact
news_event = {
	id = wsv_usa.106
	title = wsv_usa.106.t
	desc = wsv_usa.106.d
	picture =  news_event_tr_and_kaiser

	major = yes

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			USA = { 
				add_named_threat = {
					threat = 3
					name = "Signed Pact with Germany"
				}
			}
		}
	}

	option = {
		name = wsv_usa.106.a
		trigger = {
			OR = {
				tag = GER
				tag = USA
			}
		}
	}

	option = {
		name = wsv_usa.106.b
		trigger = {
			OR = {
				tag = ENG
				tag = CSA
			}
		}
	}

	option = {
		name = wsv_usa.106.c
		trigger = {
			NOT = {
				tag = GER
				tag = USA
				tag = ENG
				tag = CSA
			}
		}
	}
}



# Germany calls US into war
country_event = {
	id = wsv_usa.107
	title = wsv_usa.107.t
	desc = wsv_usa.107.d

	fire_only_once = yes

	trigger = {
		tag = USA
		NOT = { has_war_with = ENG }
		has_global_flag = american_german_pact
		GER = { has_war_with = ENG }
	}

	mean_time_to_happen = { days = 3 }

	# USA (ROOT) joins war
	option = {
		name = wsv_usa.107.a
		add_to_war = {
			targeted_alliance = GER
			enemy = ENG
		}
		# declare war on Canada & CSA if they are allied with England
		if = {
			limit = { has_global_flag = confederate_canadian_british_pact }
			declare_war_on = { 
				target = CSA 
				type = topple_government
			}
		}
		GER = { country_event = wsv_usa.110 }

		ai_chance = {
			factor = 80
		}
	}

	# USA (ROOT) rejects
	option = {
		name = wsv_usa.107.b
		clr_global_flag = american_german_pact
		GER = {
			country_event = wsv_usa.109
			add_opinion_modifier = {
				target = USA
				modifier = faction_traitor
			}
		}
	
		ai_chance = {
			factor = 0
			modifier = {
				add = 20
				is_historical_focus_on = no
				strength_ratio = {
					tag = CSA
					ratio < 1.5
				}
			}
		}
	}
}


# USA calls Germany into war
country_event = {
	id = wsv_usa.108
	title = wsv_usa.108.t
	desc = wsv_usa.108.d

	fire_only_once = yes

	trigger = {
		tag = GER
		NOT = { has_war_with = ENG }
		has_global_flag = american_german_pact
		USA = { has_war_with = ENG }
	}

	mean_time_to_happen = { days = 3 }

	# Germany (ROOT) joins war
	option = {
		name = wsv_usa.108.a
		add_to_war = {
			targeted_alliance = USA
			enemy = ENG
		}
		# declare war on France & Russia if they are allied with England
		if = {
			limit = { FRA = { is_in_faction_with = ENG } }
			declare_war_on = { target = FRA }
			if = {
				limit = { RUS = { is_in_faction_with = FRA } }
				declare_war_on = { target = RUS }
			}
		}
		USA = { country_event = wsv_usa.110 }

		ai_chance = {
			factor = 80
		}
	}

	# Germany (ROOT) rejects
	option = {
		name = wsv_usa.108.b
		clr_global_flag = american_german_pact
		USA = {
			country_event = wsv_usa.109
			add_opinion_modifier = {
				target = GER
				modifier = faction_traitor
			}
		}
	
		ai_chance = {
			factor = 0
			modifier = {
				add = 20
				is_historical_focus_on = no
				strength_ratio = {
					tag = FRA
					ratio < 1.5
				}
			}
		}
	}
}


# informed our ally refused
country_event = {
	id = wsv_usa.109
	title = wsv_usa.109.t
	desc = wsv_usa.109.d

	is_triggered_only = yes

	option = {
		name = wsv_usa.109.a
	}
}


# informed our ally we joined
country_event = {
	id = wsv_usa.110
	title = wsv_usa.110.t
	desc = wsv_usa.110.d

	is_triggered_only = yes

	option = {
		name = wsv_usa.110.a
	}
}


##########################################################
##########################################################


# Military aid to haiti
country_event = {
	id = wsv_usa.111
	title = wsv_usa.111.t
	desc = wsv_usa.111.d

	is_triggered_only = yes

	option = {
		name = wsv_usa.111.a
		
		army_experience = 10
		add_doctrine_cost_reduction = {
			name = land_doc_bonus
			cost_reduction = 0.5
			uses = 1
			category = land_doctrine
		}
	}
}


#Send arms to AUH
country_event = {
	id = wsv_usa.112
	title = wsv_usa.112.t
	desc = wsv_usa.112.d

	is_triggered_only = yes

	# cool
	option = {
		name = wsv_usa.112.a

		hidden_effect = {
			add_opinion_modifier = {
				target = USA
				modifier = HOI4TGW_Opinion_improved_diplomatic_relations
			}
		}
	}
}


# US troops land in Sandwich islands
news_event = {
	id = wsv_usa.113
	title = wsv_usa.113.t
	desc = wsv_usa.113.d
	picture =  news_event_generic_battleships

	is_triggered_only = yes
	major = yes

	immediate = {
		hidden_effect = {
			load_oob = USA_hawaii_landing
			set_country_flag = stormed_hawaii
			set_province_controller = 4180
		}
	}

	option = {
		name = wsv_usa.113.a
		trigger = {
			OR = {
				tag = USA
				is_in_faction_with = USA
			}
		}
	}
	option = {
		name = wsv_usa.113.b
		trigger = {
			has_war_with = USA
		}
	}
	option = {
		name = wsv_usa.113.c
		trigger = {
			NOT = { tag = USA }
			not = { is_in_faction_with = USA }
			NOT = { has_war_with = USA }
		}
	}
}



# Canadian rebels
country_event = {
	id = wsv_usa.114
	title = wsv_usa.114.t
	desc = wsv_usa.114.d
	picture = report_event_local_resistance

	mean_time_to_happen = {
		days = 14
	}

	trigger = {
		tag = USA
		war_length_with = { tag = CAN   months = 8 }
		any_controlled_state = { is_owned_by = CAN }			# is occupying any canadian state
		NOT = { has_country_flag = canadian_rebels_cooldown }
	}


	immediate = {
		hidden_effect = {
			USA = {
				random_controlled_state = {
					limit = { is_owned_by = CAN }
					save_event_target_as = canada_state_resistance
					damage_building = {
						type = infrastructure
						damage = 1
					}
					add_resistance = 10
				}
			}
		}
	}

	# Find the perpetrator
	option = {
		name = wsv_usa.114.a
		set_country_flag = {
			flag = canadian_rebels_cooldown 	
			days = 100
			value = 1
		}
		ai_chance = {
			factor = 40
		}
	}

	# Collective punishment
	option = {
		name  = wsv_usa.114.b
		event_target:canada_state_resistance = {
			add_resistance_target = 10
			add_compliance = -10
		}
		set_country_flag = {
			flag = canadian_rebels_cooldown 	
			days = 175
			value = 1
		}
		custom_effect_tooltip = reduce_frequency_of_canadian_rebels_tt

		ai_chance = {
			factor = 30
		}
	}
}



# Issue of Mexico  
country_event = {
	id = wsv_usa.115
	title = wsv_usa.115.t
	desc = wsv_usa.115.d

	is_triggered_only = yes

	# outreach to mexico
	option = {
		name = wsv_usa.115.a
		set_country_flag = USA_friendly_to_mexico

		ai_chance = {
			factor = 30
			modifier = {
				factor = 0
				is_historical_focus_on = yes
			}
		}
	}

	# be hostile
	option = {
		name = wsv_usa.115.a
		set_country_flag = USA_hostile_to_mexico

		ai_chance = {
			factor = 60
		}
	}
}




###############################################################


# US gets notice whether to aid black rebels or not
country_event = {
	id = wsv_usa.116
	title = wsv_usa.116.t
	desc = wsv_usa.116.d

	fire_only_once = yes
	trigger = {
		tag = USA
		has_war_with = CSA
		has_global_flag = csa_black_revolt_occured
		NOT = { has_global_flag = csa_red_rebellion_defeated }
	}

	# aid rebels
	option = {
		name = wsv_usa.116.a
		set_global_flag = usa_aiding_black_rebels
		add_equipment_to_stockpile = {
			type = infantry_equipment_0
			amount = -8000
		}
		custom_effect_tooltip = longer_black_rebellion_tt

		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				surrender_progress > 0.2
			}
		}
	}

	# no
	option = {
		name = wsv_usa.116.b
	}
}


# CSA informed that the US is helping black rebels
country_event = {
	id = wsv_usa.117
	title = wsv_usa.117.t
	desc = wsv_usa.117.d

	fire_only_once = yes
	trigger = {
		tag = CSA
		has_global_flag = csa_black_revolt_occured
		has_global_flag = usa_aiding_black_rebels
		NOT = { has_global_flag = csa_red_rebellion_defeated }
	}
	mean_time_to_happen = { days = 10 }

	option = {
		name = wsv_usa.117.a
	}
}


# Rememberance Offensive Failed 
country_event = {
	id = wsv_usa.118
	title = wsv_usa.118.t
	desc = wsv_usa.118.d

	trigger = {
		tag = USA
		has_war_with = CSA
		has_country_flag = remembrance_offensive_began
		NOT = { has_idea = USA_remembrance_offensive_idea }
		NOT = { has_country_flag = remembrance_offensive_failed }
	}

	immediate = {
		set_country_flag = remembrance_offensive_failed
	}

	option = {
		name = wsv_usa.118.a
		add_war_support = -0.15
	}
}



#################################################
## -- Resarch Sharing with Germany 
#################################################


# US asked Germany for research sharing
country_event = {
	id = wsv_usa.119
	title = wsv_usa.119.t
	desc = wsv_usa.119.d

	is_triggered_only = yes

	# agree
	option = {
		name = wsv_usa.119.a
		add_to_tech_sharing_group = american_german_research
		USA = { country_event = { id = wsv_usa.120  days = 1 } }
		ai_chance = { base = 100 }
	}
	
	#no
	option = {
		name = wsv_usa.119.b
		USA = { country_event = { id = wsv_usa.121  days = 1 } }
		ai_chance = { base = 0 }
	}
}


# Germany said yes
country_event = {
	id = wsv_usa.120
	title = wsv_usa.120.t
	desc = wsv_usa.120.d

	is_triggered_only = yes

	option = {
		name = wsv_usa.120.a
		add_to_tech_sharing_group = american_german_research
	}
}


# Germany said no
country_event = {
	id = wsv_usa.121
	title = wsv_usa.121.t
	desc = wsv_usa.121.d

	is_triggered_only = yes

	option = {
		name = wsv_usa.121.a
	}
}


#################################################


# Annex the CSA
country_event = {
	id = wsv_usa.122
	title = wsv_usa.122.t
	desc = wsv_usa.122.d

	trigger = {
		tag = USA
		has_country_flag = usa_total_war_the_south
		CSA = { 
			has_war_with = USA
			surrender_progress > 0.9
		}
	}

	option = {
		name = wsv_usa.122.a
		annex_country = {
			target = CSA
			transfer_troops = no
		}
	}
}



#################################################

# USA gets to make its own faction (fires if got locked out of focus tree)
country_event = {
	id = wsv_usa.123
	title = wsv_usa.123.t
	desc = wsv_usa.123.d

	fire_only_once = yes  # only one time

	trigger = {
		tag = USA
		has_completed_focus = USA_reaffirm_ties_germany
		NOT = { has_completed_focus = USA_american_german_pact }  # if you break the pact thats on you
		has_global_flag = british_german_detente
	}

	option = {
		name = wsv_usa.123.a
		uncomplete_national_focus = {
			focus = USA_reaffirm_ties_germany
			uncomplete_children = no
			refund_political_power = no
		}
		complete_national_focus = USA_our_own_way
	}
}







