# befriend
# conquer
# antagonize
# build_ship
# build_army
# unit_ratio
# build_building
# research_tech
# garrison
# protect
# influence
# contain
# area_priority


######################### GENERIC ##########################



# GER_francogerman_rivalry = {
# 	allowed = {
# 		original_tag = GER
# 	}
# 	enable = {
# 		FRA = { 
# 			exists = yes
# 			NOT = { is_in_faction_with = GER }
# 		}
# 	}
# 	abort = {
# 		has_war_with = RUS
# 		NOT = { has_war_with = FRA }
# 	}

# 	ai_strategy = {
# 		type = front_unit_request
# 		area = western_front		
# 		value = 100
# 	}

# 	ai_strategy = {
# 		type = area_priority
# 		id = western_front
# 		value = 50
# 	}

# 	ai_strategy = {
# 		type = area_priority
# 		id = eastern_front
# 		value = -15
# 	}
# }


GER_protect_north_coast = {
	allowed = {
		original_tag = GER
	}
	enable = {
		always = yes
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = area_priority
		id = baltic_sea
		value = 250
	}
	ai_strategy = {
		type = area_priority
		id = north_sea
		value = 100
	}
}


GER_ignore_north_america = {
	allowed = {
		original_tag = GER
	}
	enable = {
		is_in_faction_with = USA
	}
	abort = { 
		FRA = { has_capitulated = yes }
		RUS = { has_capitulated = yes }
	}

	ai_strategy = {
		type = front_unit_request
		area = north_america		
		value = -1000
	}
	ai_strategy = {
		type = dont_defend_ally_borders
		id = "USA"
		value = 100
	}	
}



######################### GREAT WAR ##########################

#stacks from base production
GER_gw_modified_unit_production = {
	allowed = {
		original_tag = GER
		has_start_date < 1937.1.1
	}
	enable = {
		always = yes
	}
	abort = { always = no }
	
	ai_strategy = {
		type = unit_ratio
		id = strategic_bomber	#we love blimps
		value = 2
	}

	ai_strategy = {
		type = equipment_production_factor
		id = infantry_equipment 
		value = 120
	}

	ai_strategy = {
		type = equipment_production_factor
		id = artillery 
		value = 35
	}

	ai_strategy = {
		type = equipment_production_factor
		id = motorized 
		value = 5
	}

	ai_strategy = {
		type = equipment_production_factor
		id = convoy
		value = 10
	}

	ai_strategy = {
		type = unit_ratio
		id = fighter
		value = 20   #stacks, total is 100
	}

	ai_strategy = {
		type = unit_ratio
		id = tactical_bomber
		value = 5
	}

	ai_strategy = {
		type = air_factory_balance
		value = 80
	}
}


GER_americam_ally_ww1 = {
	allowed = {
		original_tag = GER
		has_start_date < 1937.1.1
	}
	enable = {
		country_exists = USA
		USA = {
			NOT = { has_war_with = GER }
			#NOT = { has_completed_focus = USA_end_german-american_partnership }
		}
	}
	abort_when_not_enabled = yes
	
	ai_strategy = {
		type = befriend
		id = "USA"			
		value = 50
	}	
}


GER_anglo_german_naval_arms_race = {
	allowed = {
		original_tag = GER
	}
	enable = {
		always = yes
		date < 1914.1.1
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = antagonize
		id = "ENG"			
		value = 40
	}

	ai_strategy = {
	    type = building_target
	    id = dockyard
	    value = 10
	}
}


GER_gw_stockpile_less_early_game = {
	allowed = {
		original_tag = GER
		has_start_date < 1937.1.1
	}
	enable = {
		date > 1912.1.1
		has_army_manpower = { size < 2800000 }
		has_war = no
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = equipment_stockpile_surplus_ratio
		value = -10 # reduce while we build up in case of issues
	}
}


GER_increase_army = {		# massively increase size
	allowed = {
		original_tag = GER
		has_start_date < 1937.1.1
	}
	enable = {
		has_army_manpower = { size < 2800000 }
		date > 1913.1.1
	}
	abort_when_not_enabled = yes

	ai_strategy = {
    	type = force_build_armies
    	value = 100
	}
	ai_strategy = {
	    type = build_army
	    id = infantry
	    value = 250
	}
}



GER_no_one_gets_our_troops = {
	allowed = {
		original_tag = GER
		has_start_date < 1937.1.1
	}
	enable = {
		is_historical_focus_on = yes
		date < 1914.1.1
	}
	abort_when_not_enabled = yes
	
	ai_strategy = {
		type = send_volunteers_desire
		id = "QIN"
		value = 0
	}
	ai_strategy = {
		type = send_volunteers_desire
		id = "BUL"
		value = 0
	}
}


GER_ignore_africa = {
	allowed = {
		original_tag = GER
		has_start_date < 1937.1.1
	}
	enable = {
		country_exists = FRA
		NOT = { is_in_faction_with = FRA }
	}
	abort_when_not_enabled = yes
	
	ai_strategy = {
		type = front_unit_request
		area = africa
		value = -75
	}
}



GER_greatwar_mobilize = {
	allowed = {
		original_tag = GER		
		has_start_date < 1937.1.1
	}
	enable = {
		country_exists = FRA
		NOT = { is_in_faction_with = FRA }
		threat > 0.3
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = prepare_for_war
		id = "BEL"
		value = 100
	}

	ai_strategy = {
		type = prepare_for_war
		id = "LUX"
		value = 100
	}

	ai_strategy = {
		type = prepare_for_war
		id = "FRA"
		value = 50
	}

	ai_strategy = {
		type = prepare_for_war
		id = "RUS"
		value = 50
	}

	ai_strategy = {
		type = support
		id = "AUH"
		value = 80
	}
}



GER_der_schlieffen_plan = {
	allowed = {
		original_tag = GER
		has_start_date < 1937.1.1
	}
	enable = {
		OR = {
			# is doing schliffen focus
			focus_progress = { focus = GER_schliffen_plan  progress > 0.1 }
			# july crisis (serbia hasnt submitted)
			AND = {
				has_global_flag = news_of_european_mobilization
				NOT = { has_global_flag = serbia_submitted_to_austria }
			}
		}
	}
	abort = {
		has_war_with = FRA  #dont abort before
		OR = {
			FRA = { has_capitulated = yes }
			casualties > 350000
		}
	}

	ai_strategy = {
		type = front_control
		tag = BEL
		tag = LUX
		priority = 1000
		ratio = 0.3
		ordertype = front
		execution_type = rush
		execute_order = yes
		manual_attack = yes
	}

	ai_strategy = {
		type = front_control
		tag = FRA
		priority = 500
		ratio = 0.4
		ordertype = front
		execution_type = rush_weak
		execute_order = yes
		manual_attack = yes
	}

	ai_strategy = {
		type = prepare_for_war
		id = "BEL"			
		value = 100
	}
	
	ai_strategy = {
		type = prepare_for_war
		id = "LUX"			
		value = 100
	}
	
	ai_strategy = {
		type = prepare_for_war
		id = "RUS"			
		value = 20
	}

	ai_strategy = {
		type = front_control
		tag = RUS
		ratio = 0.4
		priority = 50
		ordertype = front
		execution_type = careful
		execute_order = no
		manual_attack = yes
	}
	
	ai_strategy = {
		type = front_unit_request
		area = western_front		
		value = 150
	}

	ai_strategy = {
		type = area_priority
		id = western_front
		value = 100
	}

	ai_strategy = {
		type = front_unit_request
		tag = RUS	
		value = -50
	}
	
	ai_strategy = {
		type = consider_weak
		id = BEL
		value = 150
	}

	ai_strategy = {
		type = dont_defend_ally_borders
		id = "AUH"
		value = 100
	}	
}


GER_defensive_if_lack_of_guns_against_FRA = {
	allowed = {
		original_tag = GER	
		has_start_date < 1937.1.1
	}
	enable = {
		has_war_with = FRA
		has_war_with = RUS   # if russia isnt in the picture be aggressive
		stockpile_ratio = {		## 3% of the armies equipment must be in reserves
			archetype = infantry_equipment
			ratio < 0.03
		}
	}
	abort = {
		OR = {
			stockpile_ratio = {		## 7% of the armies equipment must be in reserves
				archetype = infantry_equipment
				ratio > 0.07
			}
			surrender_progress > 0.15
		}		
	}

	ai_strategy = {
		type = front_control
		tag = FRA
		ratio = 0.25
		priority = 1
		ordertype = front
		execution_type = careful
		execute_order = no
		manual_attack = yes
	}
}


GER_fight_russia_slowly_1 = {
	allowed = {
		original_tag = GER	
		has_start_date < 1937.1.1
	}
	enable = {
		has_war_with = RUS
		has_war_with = FRA
		RUS = { surrender_progress < 0.1 }
		has_country_flag = schliffen_plan_failed
	}
	abort = {
		RUS = { has_capitulated = yes }
		# OR = {
		# 	RUS = { has_capitulated = yes }
		# 	# can be more aggressive if we have a lot of equipment
		# 	stockpile_ratio = {	
		# 		archetype = infantry_equipment
		# 		ratio > 0.1
		# 	}
		# 	# if doing badly in the east send troops
		# 	surrender_progress > 0.15
		# }		
	}

	ai_strategy = {
		type = front_control
		tag = RUS
		ratio = 0.55
		priority = 10
		ordertype = front
		execution_type = careful
		execute_order = yes
		manual_attack = yes
	}

	ai_strategy = {
		type = front_unit_request
		tag = RUS	
		value = -20
	}
}


GER_fight_russia_slowly_2 = {
	allowed = {
		original_tag = GER	
		has_start_date < 1937.1.1
	}
	enable = {
		has_war_with = RUS
		has_war_with = FRA
		RUS = { surrender_progress < 0.09 }
		has_country_flag = schliffen_plan_failed
	}
	abort = {
		RUS = { has_capitulated = yes }	
	}

	ai_strategy = {
		type = front_control
		tag = RUS
		ratio = 0.65
		priority = 10
		ordertype = front
		execution_type = careful
		execute_order = yes
		manual_attack = yes
	}

	ai_strategy = {
		type = front_unit_request
		tag = RUS	
		value = -35
	}
}



GER_let_austria_defend_itself = {
	allowed = {
		original_tag = GER
		has_start_date < 1937.1.1
	}
	enable = {
		is_in_faction_with = AUH
	}
	abort = {
		has_war_together_with = AUH
		OR = {
			AUH = { surrender_progress > 0.2 }
			war_length_with = { tag = RUS  months > 10 }   # start helping austria in mid 1915
		}
	}

	ai_strategy = {
		type = dont_defend_ally_borders
		id = "AUH"
		value = 100
	}	

	ai_strategy = {
		type = front_unit_request
		tag = SER		
		value = -80
	}	
}


GER_support_austria = {
	allowed = {
		original_tag = GER
		has_start_date < 1937.1.1
	}
	enable = {
		has_war = yes
		is_in_faction_with = AUH
	}
	abort_when_not_enabled = yes

	ai_strategy = {
 		type = send_lend_lease_desire
  		id = AUH
   		value = 200
   	}	
}


GER_support_turkey = {
	allowed = {
		original_tag = GER
		has_start_date < 1937.1.1
	}
	enable = {
		has_war = yes
		is_in_faction_with = TUR
	}
	abort_when_not_enabled = yes


	ai_strategy = {
 		type = send_lend_lease_desire
  		id = TUR
   		value = 100
   	}	
}


GER_save_turkey = {
	allowed = {
		original_tag = GER
		has_start_date < 1937.1.1
	}
	enable = {
		has_war = yes
		is_in_faction_with = TUR
		TUR = { surrender_progress > 0.1 }
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = force_defend_ally_borders
		id = "TUR"			
		value = 100
	}	
}


GER_garrison_belgium_and_northern_france = {
	allowed = {
		original_tag = GER
		date < 1937.1.1
	}
	enable = {
		has_war_with = BEL
		has_war_with = FRA
	}
	abort_when_not_enabled = yes


	ai_strategy = {
		type = put_unit_buffers	
		states = { 
			6
			29
			15
		}
		ratio = 0.1
		subtract_invasions_from_need = no
	}
}





########################## WW2 ##########################


#stacks from base production
GER_ww2_modified_unit_production = {
	allowed = {
		original_tag = GER
		has_start_date > 1937.1.1
	}
	enable = {
		always = yes
	}
	abort = { always = no }

	ai_strategy = {
		type = role_ratio
		id = garrison
		value = 2
	}
	# ai_strategy = {
	# 	type = role_ratio
	# 	id = armor
	# 	value = 2
	# }
	# ai_strategy = {
	# 	type = role_ratio
	# 	id = motorized
	# 	value = 2
	# }
	# ai_strategy = {
	# 	type = unit_ratio
	# 	id = fighter
	# 	value = 20   #stacks, total is 100
	# }
	# ai_strategy = {
	# 	type = unit_ratio
	# 	id = tactical_bomber
	# 	value = 10
	# }
	# ai_strategy = {
	# 	type = equipment_production_factor
	# 	id = anti_tank
	# 	value = 10
	# }
	# ai_strategy = {
	# 	type = equipment_production_factor
	# 	id = artillery
	# 	value = 10
	# }

	ai_strategy = {
		type = role_ratio
		id = armor  #we love tanks
		value = 2   
	}

	ai_strategy = {
		type = equipment_production_factor
		id = infantry
		value = 90
	}

	ai_strategy = {
		type = equipment_production_factor
		id = artillery
		value = 35
	}

	ai_strategy = {
		type = equipment_production_factor
		id = motorized
		value = 5
	}

	ai_strategy = {
		type = air_factory_balance
		value = 125
	}
}


GER_more_civs = {
	allowed = {
		original_tag = GER
		has_start_date > 1937.1.1
	}
	enable = {
		has_war = no
	}
	abort_when_not_enabled = yes
	
	ai_strategy = {
		type = added_military_to_civilian_factory_ratio		
		value = -20
	}
}


GER_support_monarchist_spain = {
	allowed = {
		original_tag = GER
		has_start_date > 1937.1.1
	}
	enable = {
		has_government = neutrality
		has_war = no
		SPR = { 
			exists = yes
			has_war_with = SPN
		}
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = befriend
		id = "SPR"			
		value = 100
	}

	ai_strategy = {
		type = support
		id = "SPR"			
		value = 200
	}

	ai_strategy = {
		type = send_lend_lease_desire
		id = "SPR"
		value = 200
	}
}


GER_prepare_against_france = {
	allowed = {
		original_tag = GER
		has_start_date > 1937.1.1
	}
	enable = {
		has_global_flag = france_demanded_plebicites
		NOT = { is_in_faction_with = FRA }
		NOT = { has_global_flag = french_plebicites_agreed }
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = prepare_for_war
		id = "FRA"			
		value = 200
	}
}


GER_prepare_against_russia = {
	allowed = {
		original_tag = GER
		has_start_date > 1937.1.1
	}
	enable = {
		has_global_flag = russia_demanded_plebicites
		NOT = { is_in_faction_with = RUS }
		NOT = { has_global_flag = eastern_plebicites_agreed }
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = prepare_for_war
		id = "RUS"			
		value = 100
	}
}


GER_eastern_puppets_build_up = {
	allowed = {
		has_start_date > 1937.1.1
	}
	enable = {
		is_in_faction_with = GER
		OR = {
			tag = UBD
			tag = LIT
			tag = UKR
			tag = POL
		}
		threat > 0.2
	}
	abort_when_not_enabled = yes

	ai_strategy = {
		type = equipment_stockpile_surplus_ratio
		value = -15 # reduce while we build up in case of issues
	}
	ai_strategy = {
		type = prepare_for_war
		id = "RUS"			
		value = 10
	}
}