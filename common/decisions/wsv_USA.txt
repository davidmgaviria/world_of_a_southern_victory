

USA_warplans_cat = {

	USA_warplan_grey = {
		icon = generic_operation

		available = {
			has_war_with = CSA
		}
		visible = {
			has_country_flag = USA_war_plan_grey
		}

		fire_only_once = yes
		days_remove = 60
		days_re_enable = 0

		targeted_modifier = {
		    tag = CSA
		    attack_bonus_against = 0.15
		    #days = 60
		}
		
		remove_effect = {
		
		}

		ai_will_do = {
			factor = 10
		}
	}


	USA_warplan_red = {
		icon = generic_operation

		available = {
			has_war_with = CAN
		}
		visible = {
			has_country_flag = USA_war_plan_red
		}

		fire_only_once = yes
		days_remove = 60
		days_re_enable = 0

		targeted_modifier = {
		    tag = CAN
		    attack_bonus_against = 0.15
		    #days = 60
		}
		
		remove_effect = {
		
		}

		ai_will_do = {
			factor = 10
		}
	}

	USA_warplan_pink = {
		icon = generic_operation

		available = {
			has_war_with = ENG
		}
		visible = {
			has_country_flag = USA_war_plan_pink
		}

		fire_only_once = yes
		days_remove = 30
		days_re_enable = 0

		complete_effect = {
			every_state = {
				limit = {
					OR = { state = 629  state = 690  state = 693 state = 696 }
				}
				add_dynamic_modifier = { modifier = USA_warplan_pink_modifier scope = USA }
			}
		}

		remove_effect = {
			hidden_effect = {
				every_state = {
					limit = {
						OR = {  state = 629  state = 690  state = 693 state = 696 }
					}
					remove_dynamic_modifier = { modifier = USA_warplan_pink_modifier }
				}
			}
		}

		ai_will_do = {
			factor = 10
		}
	}


	

}





wsv_great_war_decisions = {

	USA_barrel_roll_offensive = {
		icon = generic_operation

		available = {
			has_war_with = CSA
		}
		visible = {
			has_country_flag = barrel_roll_offensive_flag
		}

		fire_only_once = yes
		days_remove = 0
		days_re_enable = 0

		complete_effect = {
			set_country_flag = barrel_roll_offensive_started
			add_timed_idea = {
				idea = USA_barrel_offensive_idea
				days = 60
			}
			hidden_effect = { activate_mission = USA_barrel_roll_mission }
		}

		ai_will_do = {
			factor = 10
		}
	}

	USA_barrel_roll_mission = {
	    activation = {
	    	has_country_flag = barrel_roll_offensive_started
	    }
	    cancel_trigger = {
	        NOT = { has_war_with = CSA }
	    }

	    icon = mission_icon     # For GFX_decision_mission_icon
	    days_mission_timeout = 90

	    timeout_effect = {
	        add_war_support = -0.15
	        add_political_power = -75
	        hidden_effect = { country_event = wsv_usa.3 }
	    }
	}

	
	# USA throws in the towel
	greatwar_usa_offers_peace = {

		icon = generic_form_nation

		available = {
			always = yes
			OR = {
				casualties > 500000
				surrender_progress > 0.5
			}
		}

		visible = {
			tag = USA
			has_war_with = CSA
			has_global_flag = historical_treaties_on
			has_start_date < 1937.1.1
		}

		days_remove = 5

		days_re_enable = 90

		remove_effect = {
			CSA = { country_event = wsv_ahistorical_treaty.16 }
			custom_effect_tooltip = baltimore_treaty_tt
		}

		# this is done by adding and subtracting a combination of modifiers, any positive value will get the ai to surrender
		ai_will_do = {
			factor = 0

			# Negatives
			modifier = {
				add = -1
				surrender_progress < 0.10
			}
			modifier = {
				add = -1
				surrender_progress < 0.15
			}
			modifier = {
				add = -1
				surrender_progress < 0.25
			}
			modifier = {
				add = -1
				surrender_progress < 0.35
			}
			# if not fighting two fronts, less likely to surrender
			modifier = {
				add = -1
				OR = {
					NOT = { has_war_with = CSA }
					NOT = { has_war_with = CAN }
				}
			}

			# Positives
			modifier = {
				add = 1
				casualties > 1000000
			}
			modifier = {
				add = 1
				casualties > 1500000
			}		
			modifier = {
				add = 1
				casualties > 2000000
			}
			modifier = {
				add = 1
				casualties > 2500000
			}	
			modifier = {
				add = 1
				casualties > 3000000
			}
			modifier = {
				add = 1
				casualties > 4000000
			}	

			modifier = {
				add = 10
				surrender_progress > 0.55
			}
		}
	}
}


## Influence in Caribbean ##

USA_influence_in_caribbean_category = {

	USA_conduct_naval_exercise = {

		icon = generic_operation

		visible = {
			always = yes
		}
		available = {
			NOT = { has_war_with = CSA }
		}

		cost = 50
		days_remove = 20
		days_re_enable = 30

		remove_effect = {
			add_to_variable = { 
				var = USA.usa_influence_in_caribbean
				value = 10 
			}
			custom_effect_tooltip = increase_influence_by_10_tt
			# TODO : naval exercise event
		}

		ai_will_do = {
			factor = 0.03
			# increase likelyhood if US is high
			modifier = {
				factor = 2
				check_variable = { var = CSA.csa_influence_in_caribbean value = 20 compare = greater_than_or_equals }
			}
			modifier = {
				factor = 2
				check_variable = { var = CSA.csa_influence_in_caribbean value = 40 compare = greater_than_or_equals }
			}
			modifier = {
				factor = 2
				check_variable = { var = CSA.csa_influence_in_caribbean value = 60 compare = greater_than_or_equals }
			}
			# decrease likelyhood if ours is high
			modifier = {
				factor = 0.5
				check_variable = { var = USA.usa_influence_in_caribbean value = 25 compare = greater_than_or_equals }
			}
			modifier = {
				factor = 0.5
				check_variable = { var = USA.usa_influence_in_caribbean value = 50 compare = greater_than_or_equals }
			}
			modifier = {
				factor = 0.5
				check_variable = { var = USA.usa_influence_in_caribbean value = 75 compare = greater_than_or_equals }
			}
		}
	}


	USA_arms_shipments = {

		icon = generic_prepare_civil_war

		visible = {
			has_country_flag = arms_shipment_to_carribean_flag
		}

		targets = { DOM GUA HON ELS NIC COS COL VEN }

		target_trigger = {
			FROM = {
				NOT = { has_country_flag = us_sent_arms_flag }
				NOT = { has_war_with = USA }
				is_puppet = no
			}
		}
		
		cost = 15
		days_remove = 20

		complete_effect = {
			set_country_flag = sending_arms_in_progress
		}

		remove_effect = {
			clr_country_flag = sending_arms_in_progress
			send_equipment = {
				type = infantry_equipment
				amount = 1000
				target = FROM
			}
			add_to_variable = { 
				var = USA.usa_influence_in_caribbean
				value = 5 
			}
			custom_effect_tooltip = increase_influence_by_5_tt

			FROM = { 
				set_country_flag = us_sent_arms_flag 
				# country_event = { id = ? days = 1 } #TODO: event telling us we got guns  
			}
		}

		ai_will_do = {
			factor = 0.05

			modifier = {
				factor = 0
				has_country_flag = sending_arms_in_progress
			}
			modifier = {
				factor = 4
				tag = HAI
			}
			modifier = {
				factor = 2
				OR = {
					tag = DOM
					tag = COL
					tag = NIC
				}
			}
			# increase likelyhood if US is high
			modifier = {
				factor = 2
				check_variable = { CSA.csa_influence_in_caribbean value >= 20 }
			}
			modifier = {
				factor = 2
				check_variable = { CSA.csa_influence_in_caribbean value >= 40 }
			}
			modifier = {
				factor = 2
				check_variable = { CSA.csa_influence_in_caribbean value >= 60 }
			}
			# decrease likelyhood if ours is high
			modifier = {
				factor = 0.5
				check_variable = { var = USA.usa_influence_in_caribbean value = 25 compare = greater_than_or_equals }
			}
			modifier = {
				factor = 0.5
				check_variable = { var = USA.usa_influence_in_caribbean value = 50 compare = greater_than_or_equals }
			}
			modifier = {
				factor = 0.5
				check_variable = { var = USA.usa_influence_in_caribbean value = 75 compare = greater_than_or_equals }
			}
		}
	}
}






######################################################################
#########################  WORLD WAR 2  ##############################
######################################################################
